---

title: 终于搭起了博客
date: 2019-04-18 17:32:22
categories: Hexo
tags: [Hexo, NexT, 博客]
---
## 一、为什么要写这篇文章

各大网站关于搭建博客的文章已经不是一篇两篇了，但是他们的文章也有坑~`(可能是版本问题)`也各有各的特点，这里带你踩坑，并带你实现他们的特点，`stormzhang` 说过

> 把无序的信息变的有序，本质上也是信息差，也是可以创造价值的。

所以我准备整理一下各各博客的特点，尽力写成一本大全。

## 二、本文主要记载

* 搭建本地博客
* 部署到Github Pages
* 管理代码(git 基本操作)
* 装饰博客
```
阅读本文大概需要 emmmmm… ,搭建还是蛮快的大概需要 15 ~ 20 分钟,后续要做更多的话就不确定了。
本文环境是 win10 或 win 7。mac 再执行 npm 时需要在前面添加 sudo
本文整理于各大佬文章，文末会给出相应链接，如有侵权，请联系我修改或删除。
```

---

<!--more-->

## 三、搭建本地博客

### 3.1 首先安装 `Node.js`

首先去 [官方页面](https://nodejs.org/en/download/) 下载安装文件，无脑安装就好 （~。~）

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesnode.png" style="zoom:20%">

图中绿色选择部分，安装完成后输入 `npm -v` , 会告诉你版本号，就证明你安装成功了

3.2 安装 `Git`

去 [git官网](https://git-scm.com/download/win) 下载电脑对应版本，进行安装，安装完成后，输入 `git version` ，会告诉你版本号，就证明你安装成功了。安装成功后，鼠标右键菜单里会多出 `Git GUI Here` 和 `Git Bash Here` 两个按钮。

**[Git安装教程](https://www.cnblogs.com/wj-1314/p/7993819.html)  这个是百度的，如果不会查看本链接或重新百度就好~**

**我管理代码都是在 [Sourcetree](https://www.sourcetreeapp.com/) 上进行，后续会说，当然也是要 Git 的支持，这个还是很方便的，无脑操作~6**

### 3.2 安装 `Hexo`

**注意执行命令期间 `WARN` 不管 只看 `ERR` **

在文件夹内如 `D:\blog` ，鼠标右键点击 `Git Bash Here` 一气呵成，来到了命令行界面。

首先安装 `hexo` 

```
npm install hexo-cli -g
```

#### 3.2.1 镜像相关（如果 npm 可以正常使用这里跳过！）

 上面正常情况是没有问题的，但是由于国内访问官方 NPM 源速度较慢，为了一劳永逸，此处可以将 NPM 源更换为了淘宝 NPM 镜像源。
**请注意!!，如果你觉得你的 NPM 源速度够快，更换镜像源这部分可选择性使用**

在 `Git Bash Here` 中输入指令，将官方 npm 源更换为淘宝 npm 镜像源

```
npm install -g cnpm --registry=https://registry.npm.taobao.org
```

可以输入 

```
cnpm config list
```

 查看是否更换成功

**请注意，如需使用上方安装的淘宝源，需要在使用 npm 命令时将其改为 cnpm **，但是如果用了 cnpm 再使用 npm 的话，好像有点问题，npm 一直报 err 。所以这里给出卸载镜像的命令

```
npm uninstall cnpm -g
```

但是 npm 命令还是报错，还需要删除掉 `C:\Users\<电脑名字>\AppData\Roaming` 目录下  `npm-cache` 和 `npm` 文件，重新执行上面两个安装命令即可

### 3.3 Hexo初始化

安装完成后，输入 `hexo -v` 会输出 hexo 版本号，证明安装成功。

然后在当前目录新建一个文件夹，比如 `D:\blog\hexos` ，在此目录下鼠标右键点击 `Git Bash Here` 执行，这条命令需要一个空文件夹所以新建一个。

```
hexo init
```

完成后，文件目录如下

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/pictureshexo_file.png" style="zoom:100%">

这样就证明初始化完成了，然后我们继续要生成静态页面，用到的命令是

```
hexo g
```

其中，`g` 的全称是 `generate`，当然也可以用 `hexo generate` 这条命令。

然后就是运行了

```
hexo s
```

其中， `s` 的全称是 `server`，当然也可以用 `hexo server` 这条命令

然后，打开你的浏览器，输入`http://localhost:4000/` 即可看到本地静态博客

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/pictureshexo_page.png" style="zoom:20%">

本地静态博客完成 ~ 

---

## 四、部署到 Github Pages

### 4.1 注册Github账户

进入 [github首页](https://github.com/) ，点击右上角 [sign up](https://github.com/join?source=header-home) 进行注册。

### 4.2 创建项目

登录后，创建一个自己的 `GitHub Pages `。 点击头像中的 [New repository](https://github.com/new) 。

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesnew_repository.png" style="zoom:50%">

**敲黑板！！ 这里重点就是项目名称必须是 `自己名称.github.io`  **

### 4.3 配置SSH密钥

#### 4.3.1 查看是否存在SSH密钥

首先通过输入命令

```
cd ~/. ssh 
```

如果存在则会进入此目录,可以略过 4.3.2，否则会提示你不存在，那么继续 4.3.2

#### 4.3.2 创建新的SSH密钥

```
ssh-keygen -t rsa -C "your_email@example.com"
```

这将按照你提供的邮箱地址，创建一对密钥，然后让你输入 密码

```
Enter passphrase (empty for no passphrase): [Type a passphrase]
Enter same passphrase again: [Type passphrase again]
```

如果你放心，可以不用密码，直接回车，这样每次提交的时候比较方便。

#### 4.3.3 在  [GitHub](https://github.com/) 添加你的公钥

1. 首先拷贝公钥内容（ mac 可能用不了，需要手动找到这个文件复制内容）

```
clip < ~/.ssh/id_rsa.pub
```

2. 然后登陆 [GitHub](https://github.com/) ，点击头像

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturessetting.png" style="zoom:50%">

3. 进入设置页，选择SSH

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturessetting_list.png" style="zoom:50%">



4. 粘贴密钥，添加即可

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesssh_content.png" style="zoom:50%">

5. 测试

```
ssh -T git@github.com
```

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturestest_ssh.png" style="zoom:100%">

6. 设置用户信息

`Git` 会根据用户的名字和邮箱来记录提交。

```
git config --global user.name "name"
```

```
git config --global user.email "email"
```

这样就配置好了SSH

### 4.4 将本地 `Hexo` 文件编译并上传 `GitHub` 的库中

1. 打开 [github首页](https://github.com/) 登录，找到左上角自己的项目

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesgithub_list.png" style="zoom:70%">

2. 点击 clone 点击 Use SSH 并复制 `SSH` 路径

   <img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesgithub_ssh_path.png" style="zoom:70%">

3. 打开 `hexo` 目录，找到 `_config` 文件

   <img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/pictureshexo_catalog_config.png" style="zoom:70%">

4. 打开并找到 `deploy` 关键字

```
deploy:
  type: git
  repository: git@github.com:CalmCenter/calmcenter.github.io.git
  branch: master
```

**注意: 引号 后有一个空格，repository 填写 ssh 地址，branch 如果没有特殊要求，写master**

5. 编译并提交

部署前需要先装 `deployer` ，`deployer` 用于将 `hexo` 部署到  `git page` 

```
npm install hexo-deployer-git --save
```

提交前，有时候提交了不生效，需要清理一下缓存

```
hexo clean
```

编译并提交

```
hexo g -d
```

 和 `hexo g` 、 `hexo d` 一样

**提交后线上会有延迟才会展现最新效果，特别是配置样式之后**

提交过程中会让你输入一次密码，完成后就可以在外网访问博客了。[https://calmcenter.github.io/](https://calmcenter.github.io/) `https://用户名.github.io`

假如这时候，报错 `ERROR Deployer not found: git`，那么就是你的 `deployer` 没有安装成功，你需要执行如下命令再安装一次：

```
npm install hexo-deployer-git --save
```

这样，你再执行 `hexo g -d` ，你的博客就部署到 `Github` 上了。

## 五、管理代码

当我们需要在不同的终端去写博客的时候，发现 `github` 库中只有编译后的代码，所以我们需要将我们的 `hexo` 源码页放入 `github` 的分支中

首先我们需要拉取所有代码，选择一个空文件夹例如 `D:\blog\github_hexo` 

### 5.1 拉取主分支代码

#### 5.1.1 初始化 `git` 

```
git init
```

#### 5.1.2 clone 远程代码，复制刚才的 `SSH` 路径 或者 `HTTPS` 路径

```
git clone <SSH/HTTPS>
```

#### 5.1.3 和远程仓库建立关联

```
git remote add origin <SSH/HTTPS>
```

如果 `falal：remote origin already exists.` ，执行下面命令

```
git remote rm origin
```

然后再次建立关联 `git remote add origin <SSH/HTTPS>` 

### 5.2 创建分支

#### 5.2.1 查看分支情况

进入拉取下来的目录 `cd <文件名>`

查看分支，查看本地分支包括远程分支

```
git branch -a
```

#### 5.2.2 创建本地分支

创建本地分支并切换到新分支

```
git checkout -b test
```

等价于 `git branch test` 和 `git checkout test` 

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesgit_branch1.png" style="zoom:100%">

这里会告诉你本地当前所处的分支，切换分支可以用，**当你切换分支时，如果本地没有但是远程有这个分支，它会自动给你拉取远程分支，并切换**

```
git checkout test 
```

#### 5.2.3 更新远程分支

上图你可以看到本地分支比远程分支多一个 `test` 下一步就是将新分支推送至远程GitHub

```
git push origin test
```

完成后，执行查看分支命令 `git branch -a` 会发现远程 多了 `test` 分支。

**如果想删掉分支**，删除本地分支

```
git branch -d <分支名称>
```

提交删除到远程

```
git push origin --delete <分支名称>
```

### 5.3 提交源码到远程分支

#### 5.3.1 本地操作代码

在确保是 `test` 分支下，然后将 `.git` 以外的所有文件删掉，将 `hexo` 源码复制到  `D:\blog\github_hexo` 下，查看文件状态

```
git status
```

#### 5.3.2 添加到暂存区

**(最后是一个 . 或者 -A 表示所有)**

```
git add .
```

#### 5.3.3 提交本地代码库

```
git commit -m "描述"
```

#### 5.3.4 提交到远程分支

```
git push
```

如果提示没有关联，则用下面指令

```
git push --set-upstream origin <分支名>
```

### 5.5 其他终端操作

#### 5.5.1 `hexo` 环境搭建

首先创建一个空目录，初始化 `git`

```
git init
```

安装 `hexo-cli` 执行下面命令，如果该终端执行过可跳过，再次执行会报错，需要删除掉 `C:\Users\<电脑名字>\AppData\Roaming` 目录下 `npm-cache` 和 `npm` 文件，重新执行这个命令就好。`(个人多次实践出来的，不行就删。。。)` 

如果 `hexo` 命令执行过程中报 `bash: hexo: command not found` 就是没有安装 `hexo` ，需要执行下面的命令

```
npm install hexo-cli -g
```

#### 5.5.2 拉取远程分支代码

然后执行 5.1 的操作 `git clone <SSH/HTTPS>`、`git remote add origin <SSH/HTTPS>` ，将远程所有代码拉下来。当前状态你只有主分支代码，你还需要拉取你 `test` 分支的代码，进入拉取下来的目录 `cd <文件名>` 。

`git branch -a` 查看分支情况。然后切换并拉取 `test` 分支。

```
git checkout test
```

#### 5.5.3 安装环境

首先在文件目录下，安装 `hexo` 和 `deployer`

```
npm install hexo --save
```

```
npm install hexo-deployer-git --save
```

然后编译并运行

```
hexo g && hexo s
```

这样本地就好了，发布 `github` 需要配置 `SSH` 和之前 4.3 操作是一样的。

## 六、功能样式配置

### `NexT` 主题设置

**重点标注：`hexo` 根目录配置文件 `hexo/_config.yml` ，`NexT` 样式配置文件 `hexo/theme/next/_config.yml` 一定要分清，它们都叫 `_cpmfig.yml` **

[这里有很多主题](https://hexo.io/themes/) 这里主要说 [NexT](https://github.com/theme-next/hexo-theme-next) 

进入 `hexo` 文件目录 ，执行

```
git clone https://github.com/theme-next/hexo-theme-next themes/next
```

成功后，在 `hexo` 根目录中找到 `_cpmfig.yml` 文件，这是 `hexo` 的配置文件，打开找到 `theme` 字段

```
theme: next
```

这样 `next` 样式就设置好了，快打开看看吧  [http://localhost:4000/](http://localhost:4000/)

### 设置语言、标题等

在 `hexo` 的配置文件，中找到 `Site` 字段 

| 字段        | 作用                           |
| :---------- | :----------------------------- |
| title       | 网站标题                       |
| subtitle    | 副标题                         |
| description | 描述                           |
| author      | 作者(您的名字)                 |
| language    | 语言 (zh-CN，en等)             |
| timezone    | 网站时区，默认使用您电脑的时区 |

### [Live2D  GitHub](https://github.com/EYHN/hexo-helper-live2d)

我的 `Live2D` 版本是 `3.1.1`

首先安装配置 hexo-helper-live2d，在 `hexo` 根目录下执行

```
npm install hexo-helper-live2d --save
```

插件就安装完成了，你可一下选一个 [模型](https://huaji8.top/post/live2d-plugin-2.0/) 这个给出了展示效果，但是不全， [更多模型](https://github.com/xiazeyu/live2d-widget-models) 这个没有展示效果，比之前的全一点，可以自己试试效果 ~

在模型中记住自己选择模型的名字 `live2d-widget-model-你选中的模型名字` ，然后进行安装

```
npm install live2d-widget-model-wanko --save
```

然后再 `hexo` 配置文件 `_cpmfig.yml` 中，添加如下代码，**代码格式很重要！！！** 有时候复制进去没有缩进，效果是出不来的。

```
live2d:
  enable: true
  scriptFrom: local
  pluginRootPath: live2dw/
  pluginJsPath: lib/
  pluginModelPath: assets/
  tagMode: false
  debug: false
  model:
    use: live2d-widget-model-wanko
  display:
    position: left
    width: 150
    height: 300
  mobile:
    show: true
  react:
    opacity: 0.7
```

这样一只可爱的小白狗就出现了。

如果要加载自定义模型，需要将模型放到 `\themes\next\source` 目录下。然后修改根目录的配置文件 `_congig.yml`  ，将 `model.use` 写成 `/live2d_models/kesshouban/kesshouban.model.json` ，我再 `source` 下有个文件夹 `live2d_models` 这里需要指向 `.model.json` 文件。

### `NexT` 样式

在 `NexT` 主题配置文件中 `hexo/theme/next/_config.yml` ，找到 `Schemes` 字段，这里有四种样式

```
# Schemes
#scheme: Muse
#scheme: Mist
#scheme: Pisces
scheme: Gemini
```

### 图片上传 `PicGo` + `GitHub` 图床

收集自作者 [EnjoyToShare 《PicGo+GitHub图床，让Markdown飞起》](https://blog.enjoytoshare.club/article/hexo-do-optimization-picture.html)  

1. 首先下载工具

下载地址 : [PicGo v2.1.2](https://github.com/Molunerfinn/PicGo/releases/tag/v2.1.2) 

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturespicgo_down.png" style="zoom:50%">

2. 登录 `GitHub` 

创建 `Repository` 之前都讲过怎么创建，名字可以取成 `PicGo` 类似的名字，主要用于存放图片。

3. 生成 Token  

点击头像

`Settings -> Developer settings -> Personal access tokens` 

点击  `Generate new token`  

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesnew_token.png" style="zoom:80%">

<img src="https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesaccess_tokens.png" style="zoom:30%">



### 细节美化

#### 头像

在 `NexT` 主题配置文件中，找到 `avatar` 字段

| 字段    | 作用                                                         |
| ------- | ------------------------------------------------------------ |
| url     | 图片相对位置(/image/xxx.png)图片保存在  \hexo\themes\next\source\images 文件下 |
| rounded | 是否启用圆角                                                 |
| opacity | 透明度                                                       |
| rotated | 旋转动画                                                     |

#### 回到顶部

打开 `NexT` 样式配置文件 `hexo/theme/next/_config.yml` 搜索 `back2top`  

```
back2top:
  enable: true
  # 回到侧边栏顶部.
  sidebar: true
  # 滚动%标签.
  scrollpercent: true
```



#### 页面底部优化

- 跳动的心

收集自作者 [十一種情緒的堆棧](https://11.tt/posts/2018/set-up-hexo-with-coding-and-github/) 在这篇文章 1/2 处左右

效果就在本页面底部 ~ ，首先先去 [The Icons](https://fontawesome.com/v4.7.0/icons/) 选择一张图片，例如搜索 `heartbeat` ，点击进去将图片代码 `fa-heartbeat` 复制下来，打开 `NexT` 样式配置文件 `hexo/theme/next/_config.yml`，搜索 `footer` 关键字

```
footer:
  icon:
    name: fas fa-heartbeat
    animated: true
    color: "#ff0000"
```

需要将复制的图片代码粘贴到 `name` 字段，并且前面加上 fas ，如果需要动画的话，将 `animated` 设置为 `true` ，并将 `color` 修改为 `#ff0000` 。就和我底部效果一样了啦。

- 访问统计

还是在 `NexT` 样式配置文件，搜索 `busuanzi_count` 字段。

```
busuanzi_count:
  enable: true
  total_visitors: true
  total_visitors_icon: user
  total_views: true
  total_views_icon: eye
  post_views: true
  post_views_icon: eye
```

将 `enable` 设置为 `true` 就有和我底部一样的 访问统计 功能了

![](https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesvisit.png) 

统计这块还可以添加一个字数和阅读时长统计，在`hexo` 根目录配置文件 `hexo/_config.yml` 搜索 `symbols_count_time` 如果没有则添加

```
symbols_count_time:
 symbols: true 
 time: true 
 total_symbols: true 
 total_time: true
```

在 `NexT` 样式配置文件 `hexo/theme/next/_config.yml`  搜索 `symbols_count_time` 

```
symbols_count_time:
  separated_meta: true
  item_text_post: true
  item_text_total: false
  awl: 4
  wpm: 275
```

![](https://raw.githubusercontent.com/CalmCenter/picGo/master/picturesnumber.png)

**注: 格式很重要** 

#### 圆角布局

收集自作者 [EnjoyToShare](https://blog.enjoytoshare.club/article/hexo-do-optimization.html) 在这篇文章 3.12，这篇里边还有好多好看的样式 ~

在 `\themes\next\source\css\_variables` 中的 `Gemini.styl` 文件添加

```
// 修改主题页面布局为圆角
$border-radius-inner            = 15px 15px 15px 15px;
$border-radius                  = 15px;
```

#### 文章标签、分类

我们在用 `hexo new post` 创建文件时

```
hexo new post "name"
```

`hexo` 自动为我们的文章头部生成了如下的内容

```
title: 标题
date: 2019-04-18 17:32:22
```

- 首先添加分类

在 `data` 下方添加 `categories` 

```
title: 标题
date: 2019-04-18 17:32:22
```

```
categories: Hexo
```

**注意：英文冒号，还有一个空格**

这样分类就添加上了，还需要给分类一个跳转页，创建一个 `categories.md` 用于跳转

```
hexo new page categories
```

会提示我们输入目录 `\source\categories\index.md`  ，打开这个 `index.md` ，加入 `type` 这个页面用于做什么的，`comment` 是否开启评论，前提是你有评论功能的话。

```
title: categories
date: 2019-04-25 14:53:31
```

```
type: categories
comments: false
```

这样分类就设置好了，检查一下 `hexo` 根目录配置文件 `_config.yml` ，搜索  `category_dir` 字段 `category_dir: categories` 这里已经设置了分类夹的名称，如果之前创建的文件夹完成和这个不一样，需要统一才行。

- 添加标签

同样在根目录 `_config.yml` 中搜索，`tag_dir` 可以知道 `tag` 设置好的文件夹名称，`tag_dir: tags`  ，我们可以在 `categories` 下添加 `tags` 来添加标签。

```
tags: [Hexo, NexT, 博客]
```

然后添加跳转页面

```
hexo new page tags
```

创建完成后，为 `tags\index.md` 添加内容 

```
title: categories
date: 2019-04-25 15:34:07
```

```
type: tags
comments: false
```

标签比分类多一步，我们需要安装一个插件

```
npm install hexo-generator-tag --save
```

这样 `hexo g && hexo s` 编译并运行，本地就可以看到了，标签在文章底部，发现它是 `# xxx` 很难看，修改的 `#` 需要找到 `/themes/next/layout/_macro/post.swig` ，搜索 

```
rel="tag">#
```

将 `#` 换成

```
<i class="fa fa-tag"></i>
```

这里的 `fa-tag` 也是在 [The Icons](https://fontawesome.com/v4.7.0/icons/) 中的图片。

- 将标签、分类添加至做出菜单栏

打开 `NexT` 样式配置文件 `hexo/theme/next/_config.yml`   搜索 `menu` 

```
menu:
  home: / || home
  #about: /about/ || user
  tags: /tags/ || tags
  categories: /categories/ || th
  archives: /archives/ || archive
  #schedule: /schedule/ || calendar
  #sitemap: /sitemap.xml || sitemap
  #commonweal: /404/ || heartbeat
```

将 `tags` 和 `categories` 打开，完成 ~ 

#### 强调颜色

收集自作者 [Moorez](https://www.jianshu.com/p/f054333ac9e6) 

- ‘’ 内容样式的修改

打开 `\themes\next\source\css\_custom\custom.styl` ，在里面加入

```
// Custom styles.
code {
    color: #ff7600;
    background: #fbf7f8;
    margin: 2px;
}
// 大代码块的自定义样式
.highlight, pre {
    margin: 5px 0;
    padding: 5px;
    border-radius: 3px;
}
.highlight, code, pre {
    border: 1px solid #d6d6d6;
}
```

- 链接样式修改

修改文件 `themes\next\source\css\_common\components\post\post.styl`，在末尾添加如下css样式

```
// 文章内链接文本样式
.post-body p a{
  color: #0593d3;
  border-bottom: none;
  border-bottom: 1px solid #0593d3;
  &:hover {
    color: #fc6423;
    border-bottom: none;
    border-bottom: 1px solid #fc6423;
  }
}
```





------